launch:
- arg:
    name: 'use_turtlebot3' ## Default: False, Use Turtlebot4
    default: 'True'
- arg:
    name: 'use_slam_toolbox'
    default: 'False'
- arg:
    name: 'world_file'
    default: '$(find-pkg-share tb3_worlds)/worlds/sim_house.sdf.xacro'
- arg:
    name: 'map_file'
    default: '$(find-pkg-share tb3_worlds)/maps/sim_house_map.yaml'
- arg:
    name: 'gz_sdf_file'
    default: '$(find-pkg-share tb3_worlds)/urdf/gz_waffle.sdf.xacro'

- include:
    file: '$(find-pkg-share nav2_bringup)/launch/tb3_simulation_launch.py'
    if: '$(eval "$(var use_turtlebot3) == True")'
    arg:
      - name: 'headless'
        value: 'False'
      - name: 'slam'
        value: '$(var use_slam_toolbox)'
      - name: 'world'
        value: '$(var world_file)'
      - name: 'map'
        value: '$(var map_file)'
      - name: 'robot_sdf'
        value: '$(var gz_sdf_file)'
      - name: 'x_pose'
        value: '0.0'
      - name: 'y_pose'
        value: '0.0'

- include:
    file: '$(find-pkg-share nav2_bringup)/launch/tb4_simulation_launch.py'
    if: '$(eval "$(var use_turtlebot3) == False")'
    arg:
      - name: 'headless'
        value: 'False'
      - name: 'world'
        value: '$(var world_file)'
      - name: 'map'
        value: '$(var map_file)'
      - name: 'x_pose'
        value: '0.0'
      - name: 'y_pose'
        value: '0.0'

- timer:
    period: 3.0
    children:
      # Block Spawner
      - include:
          file: '$(find-pkg-share tb3_worlds)/launch/block_spawner.launch.py'
      # Set /initialpose 
      - node: 
          pkg: "tb3_worlds"
          exec: "set_init_amcl_pose.py"
          name: "initial_pose_publisher"
